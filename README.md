# VAnaliticsAPIServiceTT
## Описание
API сервис, позволяющий создавать и конфигурировать через базу данных пайплайны и шаги в рамках этих пайплайнов.
В данной конфигурации подготовлен к запуску пайплайна детекции автомобиля на изображении.

Реализованы CRUD Функции для моделей Pipeline, Step.
Реализованы Get, Delete эндпоинты для модели Car.
Реализован эндпоинт process_image, запускающий пайплайн детекции автомобиля.

## Установка
1. Клонируйте репозиторий:
```
git clone git@github.com:pdyakovlev/VAnaliticsAPIServiceTT.git
```
2. Активируйте venv и установите зависимости:
```
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```
3. Создайте в корневой директории файл .env со следующим наполнением:
```
DB_URL = Строка подключения к вашей БД
APP_TITLE = Название приложения (опционально)
DESCRIPTION = Описание приложения (Опционально)
ML_SERVICE_URL = Адрес для обращения к стороннему сервису, имитирующему ML модель

Пример можно увидеть в файле "env_example.txt"
```
4. Примените миграции для базы данных:
```
alembic upgrade head
```
## Локальный запуск
1. Из корневой директории запустите основное приложение:
```
uvicorn app.main:app --reload
```
2. Из корневой директории запустите "сторонний сервис":
```
например:
uvicorn ml_imitation.main:app --reload --port 8080
```
Сервис будет запущен и доступен по следующим адресам:
- http://127.0.0.1:8000 - Основной API
- http://127.0.0.1:8000/docs - автоматически сгенерированная документация Swagger
- http://127.0.0.1:8000/redoc - автоматически сгенерированная документация ReDoc
- http://127.0.0.1:8080 - Имитация работы ML модели
  
После запуска необходимо добавить пайплайн детекции автомобиля и его шаги следующим образом:
выполнить GET запрос к эндпоинту /pipelines/set_data, после чего в базу будут автоматически добавлены пайплайн и его шаги.

## Запуск пайплайна происходит через POST запрос к эндпоинту /process_image.

## Ключевые технологии и библиотеки:
- [Python](https://www.python.org/);
- [FastAPI](https://fastapi.tiangolo.com/);
- [SQLAlchemy](https://pypi.org/project/SQLAlchemy/);
- [Alembic](https://pypi.org/project/alembic/);
- [Pydantic](https://pypi.org/project/pydantic/);
